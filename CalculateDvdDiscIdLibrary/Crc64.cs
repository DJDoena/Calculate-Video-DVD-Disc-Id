namespace DoenaSoft.CalculateDvdDiscId
{
    partial class DvdDiscIdCalculator
    {
        private static class Crc64
        {
            /// <summary>
            /// source: https://github.com/rdp/dvdid/blob/master/0.2.0a/dvdid-0.2.0a/src/libdvdid/crc64_table.c
            /// </summary>
            private static readonly ulong[] _crc64Table =
            {
                0x0000_0000_0000_0000, 0x0809_E8A2_9694_51E9, 0x1013_D145_2D28_A3D2, 0x181A_39E7_BBBC_F23B,
                0x2027_A28A_5A51_47A4, 0x282E_4A28_CCC5_164D, 0x3034_73CF_7779_E476, 0x383D_9B6D_E1ED_B59F,
                0x404F_4514_B4A2_8F48, 0x4846_ADB6_2236_DEA1, 0x505C_9451_998A_2C9A, 0x5855_7CF3_0F1E_7D73,
                0x6068_E79E_EEF3_C8EC, 0x6861_0F3C_7867_9905, 0x707B_36DB_C3DB_6B3E, 0x7872_DE79_554F_3AD7,
                0x809E_8A29_6945_1E90, 0x8897_628B_FFD1_4F79, 0x908D_5B6C_446D_BD42, 0x9884_B3CE_D2F9_ECAB,
                0xA0B9_28A3_3314_5934, 0xA8B0_C001_A580_08DD, 0xB0AA_F9E6_1E3C_FAE6, 0xB8A3_1144_88A8_AB0F,
                0xC0D1_CF3D_DDE7_91D8, 0xC8D8_279F_4B73_C031, 0xD0C2_1E78_F0CF_320A, 0xD8CB_F6DA_665B_63E3,
                0xE0F6_6DB7_87B6_D67C, 0xE8FF_8515_1122_8795, 0xF0E5_BCF2_AA9E_75AE, 0xF8EC_5450_3C0A_2447,
                0x24B1_9099_74C8_4E69, 0x2CB8_783B_E25C_1F80, 0x34A2_41DC_59E0_EDBB, 0x3CAB_A97E_CF74_BC52,
                0x0496_3213_2E99_09CD, 0x0C9F_DAB1_B80D_5824, 0x1485_E356_03B1_AA1F, 0x1C8C_0BF4_9525_FBF6,
                0x64FE_D58D_C06A_C121, 0x6CF7_3D2F_56FE_90C8, 0x74ED_04C8_ED42_62F3, 0x7CE4_EC6A_7BD6_331A,
                0x44D9_7707_9A3B_8685, 0x4CD0_9FA5_0CAF_D76C, 0x54CA_A642_B713_2557, 0x5CC3_4EE0_2187_74BE,
                0xA42F_1AB0_1D8D_50F9, 0xAC26_F212_8B19_0110, 0xB43C_CBF5_30A5_F32B, 0xBC35_2357_A631_A2C2,
                0x8408_B83A_47DC_175D, 0x8C01_5098_D148_46B4, 0x941B_697F_6AF4_B48F, 0x9C12_81DD_FC60_E566,
                0xE460_5FA4_A92F_DFB1, 0xEC69_B706_3FBB_8E58, 0xF473_8EE1_8407_7C63, 0xFC7A_6643_1293_2D8A,
                0xC447_FD2E_F37E_9815, 0xCC4E_158C_65EA_C9FC, 0xD454_2C6B_DE56_3BC7, 0xDC5D_C4C9_48C2_6A2E,
                0x4963_2132_E990_9CD2, 0x416A_C990_7F04_CD3B, 0x5970_F077_C4B8_3F00, 0x5179_18D5_522C_6EE9,
                0x6944_83B8_B3C1_DB76, 0x614D_6B1A_2555_8A9F, 0x7957_52FD_9EE9_78A4, 0x715E_BA5F_087D_294D,
                0x092C_6426_5D32_139A, 0x0125_8C84_CBA6_4273, 0x193F_B563_701A_B048, 0x1136_5DC1_E68E_E1A1,
                0x290B_C6AC_0763_543E, 0x2102_2E0E_91F7_05D7, 0x3918_17E9_2A4B_F7EC, 0x3111_FF4B_BCDF_A605,
                0xC9FD_AB1B_80D5_8242, 0xC1F4_43B9_1641_D3AB, 0xD9EE_7A5E_ADFD_2190, 0xD1E7_92FC_3B69_7079,
                0xE9DA_0991_DA84_C5E6, 0xE1D3_E133_4C10_940F, 0xF9C9_D8D4_F7AC_6634, 0xF1C0_3076_6138_37DD,
                0x89B2_EE0F_3477_0D0A, 0x81BB_06AD_A2E3_5CE3, 0x99A1_3F4A_195F_AED8, 0x91A8_D7E8_8FCB_FF31,
                0xA995_4C85_6E26_4AAE, 0xA19C_A427_F8B2_1B47, 0xB986_9DC0_430E_E97C, 0xB18F_7562_D59A_B895,
                0x6DD2_B1AB_9D58_D2BB, 0x65DB_5909_0BCC_8352, 0x7DC1_60EE_B070_7169, 0x75C8_884C_26E4_2080,
                0x4DF5_1321_C709_951F, 0x45FC_FB83_519D_C4F6, 0x5DE6_C264_EA21_36CD, 0x55EF_2AC6_7CB5_6724,
                0x2D9D_F4BF_29FA_5DF3, 0x2594_1C1D_BF6E_0C1A, 0x3D8E_25FA_04D2_FE21, 0x3587_CD58_9246_AFC8,
                0x0DBA_5635_73AB_1A57, 0x05B3_BE97_E53F_4BBE, 0x1DA9_8770_5E83_B985, 0x15A0_6FD2_C817_E86C,
                0xED4C_3B82_F41D_CC2B, 0xE545_D320_6289_9DC2, 0xFD5F_EAC7_D935_6FF9, 0xF556_0265_4FA1_3E10,
                0xCD6B_9908_AE4C_8B8F, 0xC562_71AA_38D8_DA66, 0xDD78_484D_8364_285D, 0xD571_A0EF_15F0_79B4,
                0xAD03_7E96_40BF_4363, 0xA50A_9634_D62B_128A, 0xBD10_AFD3_6D97_E0B1, 0xB519_4771_FB03_B158,
                0x8D24_DC1C_1AEE_04C7, 0x852D_34BE_8C7A_552E, 0x9D37_0D59_37C6_A715, 0x953E_E5FB_A152_F6FC,
                0x92C6_4265_D321_39A4, 0x9ACF_AAC7_45B5_684D, 0x82D5_9320_FE09_9A76, 0x8ADC_7B82_689D_CB9F,
                0xB2E1_E0EF_8970_7E00, 0xBAE8_084D_1FE4_2FE9, 0xA2F2_31AA_A458_DDD2, 0xAAFB_D908_32CC_8C3B,
                0xD289_0771_6783_B6EC, 0xDA80_EFD3_F117_E705, 0xC29A_D634_4AAB_153E, 0xCA93_3E96_DC3F_44D7,
                0xF2AE_A5FB_3DD2_F148, 0xFAA7_4D59_AB46_A0A1, 0xE2BD_74BE_10FA_529A, 0xEAB4_9C1C_866E_0373,
                0x1258_C84C_BA64_2734, 0x1A51_20EE_2CF0_76DD, 0x024B_1909_974C_84E6, 0x0A42_F1AB_01D8_D50F,
                0x327F_6AC6_E035_6090, 0x3A76_8264_76A1_3179, 0x226C_BB83_CD1D_C342, 0x2A65_5321_5B89_92AB,
                0x5217_8D58_0EC6_A87C, 0x5A1E_65FA_9852_F995, 0x4204_5C1D_23EE_0BAE, 0x4A0D_B4BF_B57A_5A47,
                0x7230_2FD2_5497_EFD8, 0x7A39_C770_C203_BE31, 0x6223_FE97_79BF_4C0A, 0x6A2A_1635_EF2B_1DE3,
                0xB677_D2FC_A7E9_77CD, 0xBE7E_3A5E_317D_2624, 0xA664_03B9_8AC1_D41F, 0xAE6D_EB1B_1C55_85F6,
                0x9650_7076_FDB8_3069, 0x9E59_98D4_6B2C_6180, 0x8643_A133_D090_93BB, 0x8E4A_4991_4604_C252,
                0xF638_97E8_134B_F885, 0xFE31_7F4A_85DF_A96C, 0xE62B_46AD_3E63_5B57, 0xEE22_AE0F_A8F7_0ABE,
                0xD61F_3562_491A_BF21, 0xDE16_DDC0_DF8E_EEC8, 0xC60C_E427_6432_1CF3, 0xCE05_0C85_F2A6_4D1A,
                0x36E9_58D5_CEAC_695D, 0x3EE0_B077_5838_38B4, 0x26FA_8990_E384_CA8F, 0x2EF3_6132_7510_9B66,
                0x16CE_FA5F_94FD_2EF9, 0x1EC7_12FD_0269_7F10, 0x06DD_2B1A_B9D5_8D2B, 0x0ED4_C3B8_2F41_DCC2,
                0x76A6_1DC1_7A0E_E615, 0x7EAF_F563_EC9A_B7FC, 0x66B5_CC84_5726_45C7, 0x6EBC_2426_C1B2_142E,
                0x5681_BF4B_205F_A1B1, 0x5E88_57E9_B6CB_F058, 0x4692_6E0E_0D77_0263, 0x4E9B_86AC_9BE3_538A,
                0xDBA5_6357_3AB1_A576, 0xD3AC_8BF5_AC25_F49F, 0xCBB6_B212_1799_06A4, 0xC3BF_5AB0_810D_574D,
                0xFB82_C1DD_60E0_E2D2, 0xF38B_297F_F674_B33B, 0xEB91_1098_4DC8_4100, 0xE398_F83A_DB5C_10E9,
                0x9BEA_2643_8E13_2A3E, 0x93E3_CEE1_1887_7BD7, 0x8BF9_F706_A33B_89EC, 0x83F0_1FA4_35AF_D805,
                0xBBCD_84C9_D442_6D9A, 0xB3C4_6C6B_42D6_3C73, 0xABDE_558C_F96A_CE48, 0xA3D7_BD2E_6FFE_9FA1,
                0x5B3B_E97E_53F4_BBE6, 0x5332_01DC_C560_EA0F, 0x4B28_383B_7EDC_1834, 0x4321_D099_E848_49DD,
                0x7B1C_4BF4_09A5_FC42, 0x7315_A356_9F31_ADAB, 0x6B0F_9AB1_248D_5F90, 0x6306_7213_B219_0E79,
                0x1B74_AC6A_E756_34AE, 0x137D_44C8_71C2_6547, 0x0B67_7D2F_CA7E_977C, 0x036E_958D_5CEA_C695,
                0x3B53_0EE0_BD07_730A, 0x335A_E642_2B93_22E3, 0x2B40_DFA5_902F_D0D8, 0x2349_3707_06BB_8131,
                0xFF14_F3CE_4E79_EB1F, 0xF71D_1B6C_D8ED_BAF6, 0xEF07_228B_6351_48CD, 0xE70E_CA29_F5C5_1924,
                0xDF33_5144_1428_ACBB, 0xD73A_B9E6_82BC_FD52, 0xCF20_8001_3900_0F69, 0xC729_68A3_AF94_5E80,
                0xBF5B_B6DA_FADB_6457, 0xB752_5E78_6C4F_35BE, 0xAF48_679F_D7F3_C785, 0xA741_8F3D_4167_966C,
                0x9F7C_1450_A08A_23F3, 0x9775_FCF2_361E_721A, 0x8F6F_C515_8DA2_8021, 0x8766_2DB7_1B36_D1C8,
                0x7F8A_79E7_273C_F58F, 0x7783_9145_B1A8_A466, 0x6F99_A8A2_0A14_565D, 0x6790_4000_9C80_07B4,
                0x5FAD_DB6D_7D6D_B22B, 0x57A4_33CF_EBF9_E3C2, 0x4FBE_0A28_5045_11F9, 0x47B7_E28A_C6D1_4010,
                0x3FC5_3CF3_939E_7AC7, 0x37CC_D451_050A_2B2E, 0x2FD6_EDB6_BEB6_D915, 0x27DF_0514_2822_88FC,
                0x1FE2_9E79_C9CF_3D63, 0x17EB_76DB_5F5B_6C8A, 0x0FF1_4F3C_E4E7_9EB1, 0x07F8_A79E_7273_CF58,
            };

            public static ulong Calculate(byte[] data)
            {
                ulong hash = 0xFFFF_FFFF_FFFF_FFFF;

                for (int i = 0; i < data.Length; i++)
                {
                    unchecked
                    {
                        hash = (hash >> 8) ^ _crc64Table[(data[i] ^ hash) & 0xFF];
                    }
                }

                return hash;
            }
        }
    }
}